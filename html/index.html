<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>HTML/CSS Cookbook</title>
    
    <!-- Bootstrap stuff -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    
  <!-- Plugin for table of contents -->
  <!-- https://afeld.github.io/bootstrap-toc/ -->
  <link
    rel="stylesheet"
    href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"
  />
  <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script>
    
    <link rel="stylesheet" type="text/css" href="guide.css"/>
  </head>
  <body>
    <div class="page-wrapper">
      <div class="sidebar">
        <nav id="toc"></nav>
      </div>
      <div class="main-content">
        <h1 id="top">HTML/CSS Cookbook</h1>
        <p>
          This is a collection of common recipes I use to do web development 
          stuff using vanilla HTML and CSS.
        </p>
        <p>
          If you're using frontend libraries like Ant.D, Material-UI, or 
          bootstrap, you'll find components that do some of these things
          for you.
        </p>
        
        <h2>Element Toolbox</h2>
        <p>Which HTML elements to use to accomplish various tasks.</p>
        
        <h3>Headings</h3>
        <p><i>&lt;h1&gt;</i> <i>&lt;h2&gt;</i> <i>&lt;h3&gt;</i> ...</p>
        <p>The smaller the number, the larger the heading. The section headers in this guide use these.</p>
        
        <h3>Paragraphs</h3>
        <p>Enclose paragraphs with <i>&lt;p&gt;</i> tags.</p>
        
        <div class="example">
          # Paragraphs
          <p>My first paragraph.</p>
          <p>My second paragraph.</p>
          <p>Some placeholder text: Lorem.</p>
        </div>
        
        <h3>Links</h3>
        <p>
          Links use the <i>&lt;a&gt;</i> tag. I don't know why, but it's concise I guess.
        </p>
        
        <div class="example">
          # Basic Link
          <a href="http://google.com">Google</a>
        </div>
        
        <div class="example">
          # Anchor Link
          <a href="[[#top]]">Navigate to the element with <i>id="top"</i></a>
        </div>
        
        <textarea class="example">
          # New Tab
          <a href="http://google.com" [[target="blank_"]]>Open google in a new tab.</a>
        </textarea>
        
        <h3>Images</h3>
        <p>Images use the <i>&lt;img&gt;</i>.</p>
        
        <div class="example">
          # Image
          # Here's an image. By default it'd be too big so I used some css styling to make it smaller.
          # If you only scale one of the width or height, the browser will scale the other dimension proportionally.
          <img 
            style="[[width: 100px;]]"
            [[src]]="http://imageshack.us/v2_images/home-hero2.jpg">
        </div>
        
        <h3>Text</h3>
        <p>Sometimes you want to style a piece of text that does neatly fall into a heading or a paragraph.</p>
        
        <p>For this, you want to use a <i>&lt;span&gt;</i>.
        
        <div class="example">
          # Span
          This is my sentence where [[<span style="color: blue;">]]some words[[</span>]] are
          different colors from <span style="color: red">other</span> words.
        </div>
        
        <h3>Containers</h3>
        <p>Group elements together with a <i>&lt;div&gt;</i>.</p>
        
        <p><i>&lt;div&gt;</i>s are the go-to element for organizing the layout of your page.</p>
        
        <div class="example">
          # Div
          <div style="
            border: thin solid black;
            padding: 1ex;
          ">
            I'm in a div!
          </div>
          <div style="
            border: thin solid black;
            padding: 1ex;
          ">
            <div style="
              border: thin solid black;
              padding: 1ex;
            ">
              I'm in a nested div!
            </div>
            <div style="
              border: thin solid black;
              padding: 1ex;
            ">
              I'm in another nested div!
            </div>
          </div>
        </div>
                
        <h2>Less Common Elements</h2>
        <div class="example">
          # Ruler
          Use rulers to divide up 
          <hr>
          content
          <hr>
          like so.
        </div>
        
        <div class="example">
          # Ordered List
          <ol>
            <li>one</li>
            <li>two</li>
            <li>...</li>
          </ol>
        </div>
        
        <div class="example">
          # Unordered List
          <ul>
            <li>one</li>
            <li>two</li>
            <li>...</li>
          </ul>
        </div>
        
        <h2>Element Layout Basics</h2>
        <p>Most HTML elements default to either an <i>inline</i>/<i>inline-block</i> display or a <i>block</i> display.</p>
        
        <p>Elements that are displayed <i>inline</i> or <i>inline-block</i> work like text: elements flow one after another on a line, and wrap if they reach the end of their container. They also take up as little horizontal space as possible by default.</p>
        
        <div class="example">
          # Inline Elements
          Links, bold text, images, and spans appear inline:
          <a href="#">link</a>
          <strong>bold</strong> 
          <img 
            style="
              width: 100px;
            "
            src="http://imageshack.us/v2_images/home-hero2.jpg">
          <span style="color: green">span</span>.
        </div>
        
        <p>Inline elements are affected by the <i>text-align</i> attribute:</p>
        
        <div class="example">
          # Text Alignment
          <div style="text-align: left;">Left</div>
          <div style="text-align: center;">Center</div>
          <div style="text-align: right">Right</div>
        </div>
        
        <p>Elements that are displayed as <i>block</i>s render on their own line, breaking content before and after them, and they default to filling up the available width of their container.</p>
        
        <div class="example">
          # Block Elements
          Divs, headings, and paragraphs render as blocks:
          <div style="background-color: #aaaaff; width: 50px; height: 20px;"></div>
          <h6>My heading in the middle for some reason</h6>
          <p>My paragraph of text after the heading.</p>
          <p>Another paragraph of text.</p>
        </div>
        
        <h3>Controlling the Layout</h3>
        <p>If you want an element to appear in-line with text, you use the <i>display: inline;</i> property:</p>
        
        <div class="example">
          # Inline
          This is my sentence with a
          <div style="
            display: inline;
            background-color: #aaaaff;">blue inline element</div>
          in it.
        </div>
        
        By contrast, if you want an element to break text, use <i>display: block;</i>:
        
        <div class="example">
          # Block
          This is my sentence with a
          <div style="
            display: block;
            background-color: #aaaaff;">text-breaking element</div>
          in it.
        </div>
        
        You can also wrap text around elements, using <i>float: left;</i> or <i>float: right;</i>. Note that you should place a floating element directly before the body of text it's supposed to "float" in.
        
        <div class="example">
          # Floating
          <img 
            style="
              float: left;
              width: 100px;
            "
            src="http://imageshack.us/v2_images/home-hero2.jpg">
          Lorem.
        </div>
        
        <p>You've probably noticed that the image here doesn't appear to have enough space between it and the text. To fix that, we need to add a <i>margin-right: ...;</i> styling rule (<a href="#example-2">see below</a>).
        
        <h2>Margins, Padding, and Borders</h2>
        <p>These are some of the most useful CSS properties you can apply to an element.</p>
        
        <p>To use margins or padding, your element can't be <i>inline</i>, so we use <i>inline-block</i> instead (which is basically the same as <i>inline</i> except you can use margins and padding).</p>
        
        <div class="example">
          # Example 1
          <div style="background-color: grey;">
            <div style="
              display: inline-block;
              background-color: lightgrey;
              margin: 20px;
              ">
              This is the first box. It has 20px margins.
            </div>
            <div style="
              display: inline-block;
              background-color: lightgrey;
              padding: 20px;
              ">
              This is the first box. It has 20px padding.
            </div>
            <div style="
              display: inline-block;
              background-color: lightgrey;
              margin: 5px;
              padding: 15px;
              ">
              This box has 5px margins and 15px padding.
            </div>
            <div style="
              display: inline-block;
              background-color: lightgrey;
              margin: 5px;
              padding: 15px;
              border: 2px solid blue;
              ">
              This box has 5px margins and 15px padding and a blue border.
            </div>
          </div>
        </div>
        
        <p>Margins, paddings, and borders don't have to be uniform on all sides, and they can apply to any element, not just divs.</p>
        
        <div class="example">
          # Example 2
          <div style="background-color: grey;">
            <img 
              style="
                display: inline-block;
                margin: 5px;
                height: 30px;
              "
              src="http://imageshack.us/v2_images/home-hero2.jpg">
            <div style="
              display: inline-block;
              background-color: lightgrey;
              margin-bottom: 5px;
              margin-top: 15px;
              margin-left: 10px;
              margin-right: 10px;
              ">
              This box has no padding, and different margins on different sides.
            </div>
            <a href="#" style="
              border-top: thick dashed orange;
              border-bottom: thin solid cyan;
              color: white;
            ">This link has a thick dashed border on top.</a>
          </div>
        </div>
        
        
        <h2 id="page-layout">Page Layout</h2>
        <p>My two favorite tools for page layout (or the layout of individual sub-components within a page) are <i>display: flex;</i> and <i>display: grid;</i>.</p>
        
        <h3>Flex Boxes</h3>
        <p>Flex boxes give you all the power you need to arrange a single row or column of content. The obvious use-cases are things like navigation bars, but you can use them for other things too.</p>
        
        <p>For a complete guide look at <a href="https://www.w3schools.com/Css/css3_flexbox.asp">w3schools</a>, but here are some quick examples:</p>
        
        <div class="example">
          # Centering an element inside its container.
          <div style="
              display: flex;
              
              align-items: center;
              align-content: center;
              justify-items: center;
              justify-content: center;
                            
              background-color: lightgrey;
              height: 100px;
            ">
            <img 
              style="height: 50px;"
              src="http://imageshack.us/v2_images/home-hero2.jpg" />
          </div>
        </div>
        
        <div class="example">
          # Filling remaining space.
          <div style="
              display: flex;
              
              background-color: lightgrey;
              text-align: center;
            ">
            <div style="border: thin solid #888888;">One</div>
            <div style="border: thin solid #888888; flex-grow: 1;">Two</div>
            <div style="border: thin solid #888888;">Three</div>
          </div>
        </div>
        
        <div class="example">
          # Filling remaining space unevenly.
          <div style="
              display: flex;
              
              background-color: lightgrey;
              text-align: center;
            ">
            <div style="border: thin solid #888888; flex-grow: 3">One</div>
            <div style="border: thin solid #888888; flex-grow: 1;">Two</div>
            <div style="border: thin solid #888888;">Three</div>
          </div>
        </div>
        
        <div class="example">
          # Column of content.
          <div style="
              display: flex;
              flex-direction: column;
              
              background-color: lightgrey;
              text-align: center;
              
              height: 500px;
            ">
            <div style="
              border: thin solid #888888;">
              Top
            </div>
            <div style="border: thin solid #888888; display: inline-block;">
              <img 
                style="width: 300px"
                src="http://imageshack.us/v2_images/home-hero2.jpg">
            </div>
            <div style="
              border: thin solid #888888; 
              flex-grow: 1;">
              fill 1/3 of remaining space
            </div>
            <div style="
              border: thin solid #888888; 
              flex-grow: 2;">
              fill 2/3 of remaining space
            </div>
            <div style="
              border: thin solid #888888;">
              Bottom
            </div>
          </div>
        </div>
        
        <div class="example">
          # Row of columns with different alignments.
          <div style="
              display: flex;
              flex-direction: row;
            ">
            <div style="
                display: flex;
                flex-direction: column;
                
                background-color: lightgrey;
                text-align: center;
                
                align-items: start;
                
                height: 500px;
              ">
              <div style="
                border: thin solid #888888;">
                Top
              </div>
              <div style="border: thin solid #888888; display: inline-block;">
                <img 
                  style="width: 300px"
                  src="http://imageshack.us/v2_images/home-hero2.jpg">
              </div>
              <div style="
                border: thin solid #888888; 
                flex-grow: 1;">
                fill remaining space
              </div>
            </div>
            
            
            <div style="
                display: flex;
                flex-direction: column;
                
                background-color: lightgrey;
                text-align: center;
                
                align-items: center;
                
                height: 500px;
              ">
              <div style="
                border: thin solid #888888;">
                Top
              </div>
              <div style="border: thin solid #888888; display: inline-block;">
                <img 
                  style="width: 300px"
                  src="http://imageshack.us/v2_images/home-hero2.jpg">
              </div>
              <div style="
                border: thin solid #888888; 
                flex-grow: 1;">
                fill remaining space
              </div>
            </div>
            
            
            <div style="
                display: flex;
                flex-direction: column;
                
                background-color: lightgrey;
                text-align: center;
                
                align-items: flex-end;
                
                height: 500px;
              ">
              <div style="
                border: thin solid #888888;">
                Top
              </div>
              <div style="border: thin solid #888888; display: inline-block;">
                <img 
                  style="width: 300px"
                  src="http://imageshack.us/v2_images/home-hero2.jpg">
              </div>
              <div style="
                border: thin solid #888888; 
                flex-grow: 1;">
                fill remaining space
              </div>
            </div>
          </div>
        </div>
        
        <h3>Grids</h3>
        <p>Grids let you chunk up your page into arbitrary spaces.</p>
        
        <p>For a complete guide look at <a href="https://www.w3schools.com/CSS/css_grid.asp">w3schools</a>, but here are some quick examples:</p>
        
        <div class="example">
          # Standard page with sidebar.
          <div style='
              display: grid;
              
              grid-template-areas:
                "logo     header   controls"
                "sidebar  content  content"
                "footer   footer   footer"
              ;
              
              grid-template-rows: min-content 1fr min-content;
              grid-template-columns: min-content 1fr min-content;
              
              background-color: lightgrey;
            '>
            <div style="
              grid-area: logo;
              
              border: thin solid black;
              text-align: center;
              background-color: "grey">logo</div>
              
            <div style="
              grid-area: content;
              
              border: thin solid black;
              text-align: center;
              background-color: "grey">main content</div>
              
            <div style="
              grid-area: header;
              
              border: thin solid black;
              text-align: center;
              background-color: "grey">header goes here</div>
              
            <div style="
              grid-area: controls;
              
              border: thin solid black;
              text-align: center;
              background-color: "grey">Login!</div>
              
            <div style="
              grid-area: sidebar;
              
              border: thin solid black;
              text-align: center;
              background-color: "grey">
              <ul><li>something</li><li>another thing</li></ul>
            </div>
              
            <div style="
              grid-area: footer;
              
              border: thin solid black;
              text-align: center;
              background-color: "grey">copyright notice I guess</div>
              
          </div>
        </div>
        
        
        <div class="example">
          # Header and three columns.
          <div style='
              display: grid;
              
              grid-template-areas:
                "header  header  header"
                "left    center  right"
              ;
              
              grid-template-rows: 100px 1fr;
              grid-template-columns: 1fr 3fr 1fr;
              
              background-color: lightgrey;
              
              min-height: 500px;
            '>
            <div style="
              grid-area: header;
              
              border: thin solid black;
              text-align: center;
              background-color: "grey">This is my cool header that's 100 pixels tall.</div>
              
            <div style="
              grid-area: left;
              
              border: thin solid black;
              text-align: center;
              background-color: "grey">left</div>
              
            <div style="
              grid-area: center;
              
              border: thin solid black;
              text-align: center;
              background-color: "grey">center has 3/5ths of content</div>
              
            <div style="
              grid-area: right;
              
              border: thin solid black;
              text-align: center;
              background-color: "grey">right</div>
          </div>
        </div>
        
        <h2>Cosmetic Styling Rules</h2>
        <div class="example">
          # Opacity
          <div style="background-color: lightgrey; padding: 1em;">
            <div style="opacity: 0.8">80% opacity (20% transparency)</div>
            <div style="opacity: 0.4">40% opacity (60% transparency)</div>
          </div>
        </div>
        
        <div class="example">
          # Text-Decoration
          <div style="background-color: lightgrey; padding: 1em;">
            <div style="text-decoration: none;">This is the default (except for links).</div>
            <div style="text-decoration: underline;">text-decoration: underline</div>
          </div>
        </div>
        
        <div class="example">
          # Text Color
          <div style="background-color: lightgrey; padding: 1em;">
            <div style="color: white;">White</div>
            <div style="color: #ff8800;">Orange</div>
            <div style="color: rgba(0, 0, 255, 0.5);">Translucent Blue</div>
            <div style="color: hsl(120, 90%, 10%);">Dark green</div>
          </div>
        </div>
        
        <div class="example">
          # Background Color
          <div style="background-color: red;">Red</div>
          <div style="background-color: #ff8800;">Orange</div>
          <div style="background-color: rgba(0, 0, 255, 0.5);">Translucent Blue</div>
          <div style="background-color: hsl(120, 90%, 10%);">Dark green</div>
        </div>
        
        <div class="example">
          # Fonts
          <div style="font-family: monospace;">monospace</div>
          <div style="font-family: serif;">serif</div>
          <div style="font-family: sans-serif;">sans-serif</div>
          <div style="font-size: 1.5rem;">bigger</div>
          <div style="font-size: 0.5rem;">smaller</div>
          <div style="font-style: italic;">italic</div>
          <div style="font-weight: bold;">bold</div>
        </div>
        
        <div class="example">
          # Fixed-height container with scrollbar
          <div style="
            overflow-y: scroll; 
            height: 100px;">
            <ol>
              <li>one</li>
              <li>two</li>
              <li>three</li>
              <li>four</li>
              <li>five</li>
              <li>six</li>
              <li>seven</li>
              <li>eight</li>
              <li>nine</li>
              <li>ten</li>
              <li>eleven</li>
              <li>twelve</li>
              <li>thirteen</li>
              <li>fourteen</li>
              <li>fifteen</li>
            </ol>
          </div>
        </div>
        
        <div class="example">
          # Container that clips overflowing content.
          <div style="
            overflow-x: hidden;
            overflow-y: hidden;
            width: 200px;
            height: 100px;
            ">
            <img style="width: 600px" src="http://imageshack.us/v2_images/home-hero2.jpg">
          </div>
        </div>
        
        <div class="example">
          # Container with a background image.
          <div style="
            background-image: url('http://imageshack.us/v2_images/home-hero2.jpg');
            height: 100px;
            ">
          </div>
        </div>
        
        <div class="example">
          # Cursor control.
          <div style="cursor: default;    border: thin solid black;">default</div>
          <div style="cursor: pointer;    border: thin solid black;">pointer</div>
          <div style="cursor: move;       border: thin solid black;">move</div>
          <div style="cursor: crosshair;  border: thin solid black;">crosshair</div>
          <div style="cursor: ns-resize;  border: thin solid black;">ns-resize</div>
          <div style="cursor: text;       border: thin solid black;">text</div>
          <div style="cursor: wait;       border: thin solid black;">wait</div>
          <div style="cursor: none;       border: thin solid black;">none</div>
          <div style="cursor: grab;       border: thin solid black;">grab</div>
        </div>
        
        <div class="example">
          # Text Wrapping
          <div style="overflow-x: hidden; width: 80vw;">
            <div style="white-space: nowrap;">No-Wrap: Lorem.</div>
            <hr>
            <div style="white-space: wrap;">Wrap: Lorem.</div>
          </div>
        </div>
        
        <h2>Advanced Examples</h2>
        <p>These are specific examples that you won't run into for most projects.</p>
        
        <h3>Code Blocks</h3>
        <p>To make the code blocks you see here, I used a <i>&lt;pre&gt;</i> element styled as monospaced with a grey background.</p>
        
        <p><i>&lt;pre&gt;</i> elements render text in a way that preserves the literal whitespace inside them (html normally ignores indentation and new lines, treating any amount of whitespace as a single space character).</p>
        
        <p>That's not enough, though. If in order to render raw html tags &lt;&gt;, you have to use HTML entities, to stop the browser from trying to render it.
        
        <div class="card">
          <div class="card-body">
            <h5>CSS</h5>
            <p>The below CSS class applies to all <i>&lt;pre&gt;</i> elements that have <i>class="code"</i>.
            <pre class="code">
pre.code {
  display: block;
  background-color: #eeeeee;
  font-family: monospace;
  font-style: normal;
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
  border: 0;
  width: 100%;
  overflow-x: scroll;
  overflow-y: hidden;
  white-space: pre;
  padding: 1em;
  font-size: 1.1rem;
}
            </pre>
          </div>
        </div>
        
        <div class="example">
          # HTML
          # The below HTML defines a <i>&lt;pre&gt;</i> that renders some simple code.
          <pre class="code">
&lt;div&gt;
  Some text inside the div.
&lt;/div&gt;
          </pre>
        </div>
        <p>And yes... to write the above example, I had to escape the <i>&amp;lt;</i>'s too, so they wouldn't just render as <i>&lt;</i>. I did that with <i>&amp;amp;lt;</i>.</p>
        <p>For most of these examples I didn't do it by hand, I wrote some javascript to escape the html for me (feel free to inspect the source of this page to find that, this is getting too meta).</p>
        
        
        <h3>Inline Code Snippets</h3>
        <p>This is easier than code blocks, because we don't have to care as
        much about the formatting.</p>
        
        In principle, it's a simple as:
        <div class="example">
          # CSS: &lt;span class="inline-code"&gt;
          # Style all elements that have <i>class="inline-code"</i>.
          .inline-code {
            display: inline;
            background-color: #dfdfdf;
            font-family: monospace;
            font-style: normal;
            padding: 2px;
          }
        </div>
        <div class="example">
          # HTML: &lt;span class="inline-code"&gt;
          <p>This is my sentence with some <span class="inline-code">&lt;code&gt;</span> in it.</p>
        </div>
        
        <p>In practice, <i>&lt;span class="inline-code"&gt;</i> is a lot of typing. Instead, I did what a lot of coding websites do, and I repurposed the <i>&lt;i&gt;</i> element.</p>
        
        <p>The <i>&lt;i&gt;</i> element was originally made to do italics, but italics aren't very commonly used anymore on the web (so it's simple enough to just use a custom-styled <i>&lt;span&gt;</i> when you need it).</p>
        
        <p>So my code looks like:</p>
        <div class="example">
          # CSS: &lt;i&gt;
          # Style all <i>&lt;i&gt;</i> elements.
          i {
            display: inline;
            background-color: #dfdfdf;
            font-family: monospace;
            font-style: normal;
            padding: 2px;
          }
        </div>
        <div class="example">
          # HTML &lt;i&gt;
          <p>This is my sentence with some <i>&lt;code&gt;</i> in it.</p>
        </div>
        
      </div>
    </div>
    <script type="text/javascript">
    let dedent = (text) => {
      let lines = text.split('\n');
      let indent = -1;
      for (let i = 0; i < lines.length; i++) {
        if (lines[i].trim().length === 0) {
          continue;
        }
        let spaces = 0;
        for (; spaces < lines[i].length && lines[i].charAt(spaces) === ' '; spaces++) {
        }
        if (indent < 0 || spaces < indent) {
          indent = spaces;
        }
      }
      return lines.map(line => {
        if (line.trim().length === 0) return '';
        return line.substring(indent);
      }).join('\n');
    };
    
    let walk = (node, consumer) => {
      consumer(node);
      for (let n = node.firstChild; n; n = n.nextSibling) {
        walk(n, consumer);
      }
    };
    
    let argmin = (array, func) => {
      let minKey = null;
      let minValue = 0;
      array.forEach(key => {
        let value = func(key);
        if (minKey === null || value < minValue) {
          minKey = key;
          minValue = value;
        }
      });
      return minKey;
    };
    
    let escape = (text) => {
      return text
        .replace(/&lt;/g, '&amp;lt;')
        .replace(/&gt;/g, '&amp;gt;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
    };
    
    let formatCode = (text, forCodeSample) => {
      if (forCodeSample) {
        return dedent(escape(text))
          .replace(/\[\[/g, '<span class="important-code">')
          .replace(/\]\]/g, '</span>');
      }
      return text
        .replace(/\[\[/g, '')
        .replace(/\]\]/g, '');
    };
    
    $(document).ready(() => {
      $('.example').each((index, code) => {
        let data = code.tagName === 'TEXTAREA'
          ? $(code).val() : $(code).html();
          
        data = data.replace(/Lorem./g, dedent(`
        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
        `));
        let lines = data.split('\n').filter(l => l.trim().length > 0);
        let title = lines.filter(line => line.trim().startsWith('# '))
          .map(line => line.trim().substring(1).trim())[0] || 'Example';
        let prose = lines
          .filter((line, i) => i > 0)
          .filter(line => line.trim().startsWith('# '))
          .map(line => line.trim().substring(1).trim())
          .join('\n');
          
          
        lines = lines.filter(line => !line.trim().startsWith('# '));
        data = lines.join('\n');
        
        let isHtml = data.indexOf('<') >= 0;
        $(code).replaceWith($(`
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">${title}</h5>
              ${prose ? `<p>${prose.split('\n').join('</p><p>')}</p>` : ''}
              ${isHtml ? `<div class="card-title">Code</div>` : ''}
              <pre class="code">${formatCode(data, true)}</pre>
              ${isHtml ? `
              <hr>
              <div class="card-title">Output</div>
              <div class="bd-callout bd-callout-info">
                ${formatCode(data, false)}
              </div>
              ` : ''}
            </div>
          </div>
        `));
      });
      
      let used = {};
      let lastLevel = 1;
      let indent = 0;
      walk($('.main-content')[0], node => {
        if (!node.tagName) return;
        
        let match = /H([0-5])/g.exec(node.tagName);
        if (!match) return;

        let level = parseInt(match[1], 10);
        if (level > 1) {
          // We put h2's on the same level as h1 to
          // save horizontal space, since the h1 only
          // is used for the title of the page.
          level--;
        }
        
        if (level > lastLevel) {
          indent += 1;
        } else if (level < lastLevel) {
          indent -= 1;
        }
        indent = Math.min(indent, level - 1);
        lastLevel = level;
        
        
        let title = node.innerHTML;
        let id = title.toLowerCase().trim().replace(/\W+/g, '-');
        let baseId = id;
        for (let i = 1; used.hasOwnProperty(id); i++) {
          id = `${baseId}-${i + 1}`;
        }
        used[id] = true;
        
        $(node).attr('id', id);
        
        $('#toc').append(`
          <a 
            href="#${id}" 
            class="nav-link"
            style="
              margin-left: ${(indent - 1)*1}rem;
              font-size: ${1.0/Math.pow(1.05, indent)}em;
          ">${title}</a>
        `);
      });
      
      let anchor = window.top.location.hash;
      if (anchor) {
        let el = $(anchor);
        if (el.length > 0) {
          $('.main-content').scrollTop(el.offset().top);
        }
      }
      
      $('.main-content').scroll(() => {
        let anchorIds = Object.keys(used).map(id => `#${id}`);
        let closest = argmin(anchorIds, id => Math.abs($(id).offset().top));
        if (window.top.location.href !== closest) {
          history.pushState(null, null, closest);
        }
        $(`.nav-link[href='${closest}']`).attr('class', 'nav-link active');
        $(`.nav-link[href!='${closest}']`).attr('class', 'nav-link');
      });
    });
    
    </script>
  </body>
</html>